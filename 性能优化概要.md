## 0x1 使用profile

程序运行的时间90%花费在10%的代码上，有效的使用profile可以很好的帮助解决这些问题。使用100小时在这10%的代码上进行优化，也比花100小时在90%的代码上优化效益高得多。使用profile看到函数的调用层次，调用次数，以及每条代码的时间分解表（甚至可以到汇编级）。而不是把时间花费在错误的，无用的方向上去优化。注意两点：

* 花费时间多的函数需要优化其算法
* 调用次数巨多的函数——如果一个函数每秒被调用300K次，那么只需要优化0.001ms，那也是相当巨大的优化，这就是所谓10%的代码占用90%的CPU耗时

## 0X2 查看汇编

当遇到不熟悉的语言，直接查看汇编代码简单粗暴。经常查看汇编代码会让你发现一些意想不到的东西让你知道为什么程序的性能是这样，一些意想不到的函数调用，预料不到的自傲，以及一些不应该存在的东西



对程序性能优化，最基本的方法就是使用一个profile和去查看一下汇编来找到程序的瓶颈，找到瓶颈后去真正的思考如何改进，是用更好的算法，还是更快的语言等等。常规做法是挑选一个最佳算法而不是进行微优化。虽然这种做法无可异议，但是有两件事需要重点注意。第一个也是最重要的，如果选择的算法没有参与到程序性能中的算法，那么优化也只是在浪费时间和精力，还转移了注意力从而错过了最需要优化的部分。第二点，算法的性能总和需要处理的数据密切相关，就算冒泡有这么多笑柄，但是如果处理的数据是基本排好序的，只有中间几个数据未排序，那么冒泡则是所有排序算法里性能最好的。所以，担心没有使用好算法而不去测试，只会浪费时间。没有profile，就不会知道问题在哪，不去看汇编，就有可能知道问题出在，哪但不知道为什么。